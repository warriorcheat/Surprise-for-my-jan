<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>For My Love</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Arial,Helvetica,sans-serif;
}

body{
  background:#000;
  color:#fff;
  min-height:100vh;
}

.screen{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:20px;
  animation:fade .8s ease;
}

.hidden{display:none}

@keyframes fade{
  from{opacity:0}
  to{opacity:1}
}

h1,h2,p{margin-bottom:15px}

.btn{
  padding:12px 35px;
  margin:10px;
  border:none;
  border-radius:30px;
  font-size:16px;
  cursor:pointer;
  background:#fff;
  color:#000;
}

#adminKey{
  position:fixed;
  bottom:10px;
  right:10px;
  font-size:20px;
  cursor:pointer;
}

.adminPanel{
  position:fixed;
  inset:0;
  background:#000;
  padding:20px;
  z-index:999;
  overflow:auto;
}

.voiceItem{
  border:1px solid #fff;
  padding:10px;
  margin:10px 0;
}
</style>
</head>

<body>

<div id="step1" class="screen">
  <h1>I love you my Jan Prapti ‚ù§Ô∏è</h1>
  <h2>Will you marry me?</h2>
  <button class="btn" onclick="goStep2()">Yes</button>
  <button class="btn" onclick="alert('No option disabled')">No</button>
</div>

<div id="step2" class="screen hidden">
  <h2>Say ‚ÄúKobul‚Äù üé§</h2>
  <button class="btn" onclick="startRec()">Start Voice</button>
  <button class="btn hidden" id="stopBtn" onclick="stopRec()">Stop</button>
</div>

<div id="step3" class="screen hidden">
  <h2>Fingerprint Verification</h2>
  <button class="btn" onclick="complete()">Scan Finger</button>
</div>

<div id="step4" class="screen hidden">
  <h2>Marriage Complete üíç</h2>
  <p>Abdullah is now your husband</p>
  <button class="btn" onclick="downloadCert()">Download Certificate</button>
</div>

<div id="adminKey" onclick="openAdmin()">üîë</div>

<audio autoplay loop>
  <source src="https://github.com/warriorcheat/Surprise-for-my-jan/raw/refs/heads/main/music.mp3">
</audio>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyCXXYQnIt8ovhEidRTx-B3S0k9DZV1oi7M",
  authDomain:"for-my-love-5c7c1.firebaseapp.com",
  projectId:"for-my-love-5c7c1",
  storageBucket:"for-my-love-5c7c1.firebasestorage.app",
  appId:"1:770806135468:web:f36370075360be8d1fbd09"
});
const storage=firebase.storage();

/* FLOW */
function goStep2(){
  step1.classList.add("hidden");
  step2.classList.remove("hidden");
}

/* VOICE */
let recorder,chunks=[];
async function startRec(){
  const s=await navigator.mediaDevices.getUserMedia({audio:true});
  recorder=new MediaRecorder(s);
  chunks=[];
  recorder.ondataavailable=e=>chunks.push(e.data);
  recorder.start();
  stopBtn.classList.remove("hidden");
}
function stopRec(){
  recorder.stop();
  recorder.onstop=async()=>{
    const blob=new Blob(chunks,{type:"audio/webm"});
    await storage.ref("voices/"+Date.now()+".webm").put(blob);
    step2.classList.add("hidden");
    step3.classList.remove("hidden");
  }
}

/* COMPLETE */
function complete(){
  step3.classList.add("hidden");
  step4.classList.remove("hidden");
}

function downloadCert(){
  const t="Marriage Certificate\nAbdullah ‚ù§Ô∏è Prapti";
  const b=new Blob([t],{type:"text/plain"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="Marriage-Certificate.txt";
  a.click();
}

/* ADMIN */
function openAdmin(){
  const o=document.createElement("div");
  o.className="adminPanel";
  o.innerHTML=`
    <h2>Admin Login</h2>
    <input id="pin" type="password" placeholder="PIN" style="padding:10px;width:100%;margin:10px 0">
    <button class="btn" onclick="checkPin()">Unlock</button>
  `;
  document.body.appendChild(o);
}
async function checkPin(){
  if(pin.value!=="112211"){alert("Wrong PIN");return}
  document.body.lastChild.remove();
  const p=document.createElement("div");
  p.className="adminPanel";
  p.innerHTML="<h2>Saved Voices</h2>";
  const list=await storage.ref("voices").listAll();
  for(const i of list.items){
    const u=await i.getDownloadURL();
    p.innerHTML+=`
      <div class="voiceItem">
        <audio controls src="${u}"></audio><br>
        <a href="${u}" download>Download</a>
        <button onclick="storage.ref('${i.fullPath}').delete().then(()=>location.reload())">Delete</button>
      </div>`;
  }
  p.innerHTML+=`<button class="btn" onclick="this.parentElement.remove()">Close</button>`;
  document.body.appendChild(p);
}
</script>

</body>
</html>
