<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Forever & Always üíç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  height:100vh;
  background:radial-gradient(circle at top,#160c2a,#05020a 70%);
  font-family:Poppins,sans-serif;
  color:#fff;
  overflow:hidden;
}
.bg-glow{
  position:absolute;inset:-20%;
  background:radial-gradient(circle,rgba(255,215,0,.15),transparent 60%);
  animation:spin 40s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
.particle{
  position:absolute;width:6px;height:6px;border-radius:50%;
  background:gold;animation:float 14s linear infinite;
}
@keyframes float{
  from{transform:translateY(110vh)}
  to{transform:translateY(-20vh)}
}
.card{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
.hide{display:none}
.glass{
  width:92%;max-width:480px;
  padding:45px;border-radius:34px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(40px);
  box-shadow:0 40px 120px #000;
  text-align:center;
}
h1,h2{font-family:Playfair Display;margin-bottom:15px}
button{
  padding:15px 40px;border-radius:999px;border:none;
  background:linear-gradient(135deg,#d4af37,#fff1b8,#c89b3c);
  cursor:pointer;margin:6px;
}
.voice{
  width:120px;height:120px;border-radius:50%;
  border:2px solid gold;
  display:flex;align-items:center;justify-content:center;
  font-size:50px;cursor:pointer;
}
.recording{background:red}
.key{position:fixed;bottom:12px;right:12px;font-size:26px;cursor:pointer}
.admin-panel{
  position:fixed;inset:0;background:#000;
  overflow:auto;padding:20px
}
.voice-item{margin:10px 0}
</style>
</head>

<body>

<div class="bg-glow"></div>

<audio id="music" loop>
  <source src="https://github.com/warriorcheat/Surprise-for-my-jan/raw/refs/heads/main/music.mp3">
</audio>

<div class="card" id="love">
  <div class="glass">
    <h1>I love you my Jan Prapti ‚ù§Ô∏è</h1>
    <h2>Will you marry me?</h2>
    <button onclick="yes()">Yes üíç</button>
  </div>
</div>

<div class="card hide" id="kobul">
  <div class="glass">
    <h2>Say Kobul ‚ù§Ô∏è</h2>
    <div class="voice" id="mic">üé§</div>
    <p id="status"></p>
    <button onclick="next()">Continue</button>
  </div>
</div>

<div class="card hide" id="done">
  <div class="glass">
    <h2 style="color:gold">Marriage Complete üíç</h2>
  </div>
</div>

<div class="key" onclick="admin()">üîë</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
for(let i=0;i<40;i++){
  let p=document.createElement("div");
  p.className="particle";
  p.style.left=Math.random()*100+"vw";
  p.style.animationDelay=Math.random()*8+"s";
  document.body.appendChild(p);
}

/* Firebase */
firebase.initializeApp({
  apiKey:"AIzaSyCXXYQnIt8ovhEidRTx-B3S0k9DZV1oi7M",
  authDomain:"for-my-love-5c7c1.firebaseapp.com",
  projectId:"for-my-love-5c7c1",
  storageBucket:"for-my-love-5c7c1.firebasestorage.app"
});
const storage=firebase.storage();
const db=firebase.firestore();

let recorder,stream,chunks=[];

mic.onclick=async()=>{
  if(!recorder){
    stream=await navigator.mediaDevices.getUserMedia({audio:true});
    recorder=new MediaRecorder(stream);
    recorder.ondataavailable=e=>chunks.push(e.data);
    recorder.onstop=upload;
    recorder.start();
    mic.classList.add("recording");
    status.innerText="Recording...";
  }else{
    recorder.stop();
    stream.getTracks().forEach(t=>t.stop());
    recorder=null;
    mic.classList.remove("recording");
    status.innerText="Uploading...";
  }
};

async function upload(){
  const blob=new Blob(chunks,{type:"audio/webm"});
  chunks=[];
  const ref=storage.ref("voices/"+Date.now()+".webm");
  await ref.put(blob);
  const url=await ref.getDownloadURL();
  await db.collection("voices").add({url,time:Date.now()});
  status.innerText="Saved ‚ù§Ô∏è";
}

function yes(){
  music.play().catch(()=>{});
  love.classList.add("hide");
  kobul.classList.remove("hide");
}
function next(){
  kobul.classList.add("hide");
  done.classList.remove("hide");
}

async function admin(){
  if(prompt("PIN")!=="112211")return alert("Wrong PIN");
  const panel=document.createElement("div");
  panel.className="admin-panel";
  panel.innerHTML="<h2>Admin Panel</h2>";
  const snap=await db.collection("voices").get();
  snap.forEach(doc=>{
    const d=document.createElement("div");
    d.className="voice-item";
    d.innerHTML=`
      <audio controls src="${doc.data().url}"></audio>
      <button onclick="window.open('${doc.data().url}')">Download</button>
      <button onclick="this.parentNode.remove()">Delete</button>
    `;
    panel.appendChild(d);
  });
  panel.onclick=e=>{if(e.target===panel)panel.remove()}
  document.body.appendChild(panel);
}
</script>
</body>
</html>
